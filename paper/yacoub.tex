\documentclass[conference, 10pt]{IEEEtran}
\usepackage[cmex10]{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{color}
\usepackage{placeins}
\usepackage{bm}
\usepackage{cite}
%\usepackage{stfloats}
\usepackage{float}
\usepackage{hyperref}
\usepackage{cite}
\usepackage{tabularx,colortbl}

\begin{document}
\title{\texttt{yacoub}: a Python package for Simulating Generalized Fading Channels}

\author{\IEEEauthorblockN{Jos\'e~V.~de~M.~Cardoso,~Paulo~R.~Lins~J\'unior,}
        \IEEEauthorblockN{~Wamberto~J.~L.~Queiroz,~and~Marcelo~S.~Alencar,~\textit{IEEE Senior Member}}
\IEEEauthorblockA{Universidade Federal de Campina Grande\\
Instituto Federal de Educa\c c\~ao, Ciencia, e Tecnologia da Para\'iba\\
Campina Grande, Para\'iba, Brasil\\
\{josevinicius,paulo,wamberto,malencar\}@iecom.org.br\\}
}

\maketitle

\begin{abstract}
    We present a well tested Python-based library for simulating and computing
    generalized fading channels, named \texttt{yacoub}. We describe the
    applicability of \texttt{yacoub} using examples in recent communications
    systems challenges, namely: spectrum sensing, bit error rate computation,
    and parameter estimation in generalized fading channels. The development of
    \texttt{yacoub} open source and its code is avaliable at
    \texttt{http://github.com/mirca/yacoub}.
\end{abstract}

\IEEEpeerreviewmaketitle
\section{Introduction}

\subsection{Note on notation}
Scalars and random variables are denoted as \textit{italic} small-case letters \textit{e.g.} $x$;
vectors and random vectors are denoted as \textit{italic}, boldface, small-case letters \textit{e.g.} $\bm{x}$.
The $n-$th component of a vector $\bm{x}$ is denoted as $x_n$.
A complex vector of length $n$ is defined as $\bm{x} \in \mathbb{C}^{n\times 1}$. All
vectors are column vectors. Matrices are denoted as \textit{italic}, boldface, capital
letters as in $\bm{X}$; the identity matrix of order $n$ is denoted as $\bm{I}_n$.
We define a discrete-time circularly symmetric Gaussian process $\bm{z}$ as any collection
of random varibles $\bm{z}~=~\bm{x}~+~j\bm{y}$, $j \triangleq \sqrt{-1}$, such that
$\bm{x}$ and $\bm{y}$ are iid jointly Gaussian with zero mean vector and covariance
matrix given by $\mathbb{E}\left[\bm{z}\bm{z}^{\dagger}\right]$, in which $\bm{z}^\dagger$
means the conjugate transpose of $\bm{z}$. The expectation value wrt a random variable $x$
is denoted as $\mathbb{E}_x$. The probability of an event $A$ is denoted as $\mathbb{P}(A)$.
The indicator function is denoted as $\mathbb{I}(\cdot)$ and it evaluates to $1$ if its
argument is true and $0$ otherwise.

\section{The Acceptance-Rejection sampler in log-space}

\section{Majorization-Minimization Algorithms}

\section{Examples}
\subsection{Spectrum Sensing in Complex Generalized Fading Channels}

The spectrum sensing problem consists in deciding whether or not a given channel
frequency band is being occupied by a licensed (primary) user and, in case that such
frequency band is available, how to opportuniscally allocate secondary users
such that the interference on the primary user is negligible.

From a probabilistic point of view, the spectrum sensing problem may be framed as
a decision theory problem, as follows
\begin{align}
    H_0:~& \bm{y} = \bm{w},\\
    H_1:~& \bm{y} = h\bm{s} + \bm{w},
\end{align}
in which $\bm{y} \in \mathbb{C}^{n\times 1}$ is the decoded received vector signal,
$\bm{w} \in \mathbb{C}^{n\times 1}$ is complex Gaussian noise process with zero mean
vector and covariance matrix given as $\sigma^2\bm{I}_n$, and $h$ is the channel gain.

In~\cite{cardoso2017}, the authors have shown that the probability distribution of the
energy statistic $\tilde{y} \triangleq \bm{y}^{\dagger}\bm{y}$ conditioned on the knowledge of $h$,
in case that $\bm{s}$ is an $M$-PSK signal such that every symbol has the same probability of occurrence,
$\mathbb{P}(s_n = s) = \frac{1}{M}$, is given as
\begin{align}
    p(\tilde{y} | h, H_1) = 1 - Q_{n}\left(\sqrt{\dfrac{2n|h|^2E_s}{\sigma^2}}, \sqrt{\dfrac{2\tilde{y}}{\sigma^2}}\right),
\end{align}
in which $Q_{n}$ is the Marcum-$Q$ function and $E_s$ is the energy per symbol.

The pdf of $\tilde{y}$ can be written using the Law of Total Expectation
\begin{align}
    p(\tilde{y} | H_1) = \mathbb{E}_{h}\left[p(\tilde{y} | h, H_{1})\right]
                 = \int_{-\infty}^{+\infty} p(\tilde{y} | h, H_1)p(h)\;\mathrm{d}h.
\end{align}

Recall that the energy detection rule can be expressed as
\begin{equation}
    d_\delta (\tilde{y}) = \mathbb{I}(\tilde{y} > \delta)
\right.
\end{equation}
in which $\delta$ is a strictly positive real number known as energy threshold,
and $d_\delta (\tilde{y}) = j,~j \in \{0,1\}$, means that the detector has decided
in favor of the hypothesis $H_j$.

As a result, the probabilities of false alarm and miss detection can
be written as
\begin{align}
    p_f &\triangleq \mathbb{P}\left(d_\delta(\tilde{y}) = 1 | H_0\right) = 1 -  p(\delta | H_0),\label{eq:pf} \\
    p_d &\triangleq \mathbb{P}\left(d_\delta(\tilde{y}) = 0 | H_1\right) = \mathbb{E}_{h}\left[p(\delta, h | H_1)\right],
\label{eq:pd}
\end{align}

\subsection{Parameter Estimation in Nakagami-$m$ fading}
\begin{align}
p(\bm{h}) = & \prod_{i=1}^{n}\dfrac{2m^m}{\Gamma(m)\Omega^{m}}h_i^{2m - 1}
              \exp\left(-\dfrac{mh_i^2}{\Omega}\right) \\
          = & \left(\dfrac{2m^m}{\Gamma(m)\Omega^{m}}\right)^{n}
          \exp\left(-\dfrac{m\sum_{i=1}^{n}h_i^2}{\Omega}\right) \prod_{i=1}^{n}h_i^{2m - 1}
\end{align}
\begin{align}
    \log p(\bm{h}) \cong &~n\left(m\left(\log m - \log\Omega\right) - \log\Gamma(m)\right)\nonumber
    \\ & -m\left(\dfrac{\sum_{i=1}^{n}h_i^2}{\Omega} - 2\sum_{i=1}^{n}\log h_i\right)
    \label{eq:loglike}
\end{align}

A direct maximum likelihood estimator for (\ref{eq:loglike}) has been investigated to be infeasible~\cite{paper}.

Therefore, we use a Majorization-Minimization algorithm to find smooth
and easy to optimize upper bounds for $\log p(\bm{h})$.

Note that,
\begin{align}
    -\log\Gamma(m) \geq &-\log\Gamma(m_t) + (m - m_t) \nonumber \\
                        &+ \left(m_t - \dfrac{1}{2}\right)\log (m_t-1)\nonumber\\
                        &-\left(m - \dfrac{1}{2}\right)\log (m-1), m \geq m_t > 1
\end{align}
and
\begin{align}
    &m \log m \geq m\log m_t + m - m_t,~m > 0\\
    & - m\log (m-1) \geq - \log(m-1) - (m-1)\left(\log (m_t-1) + \dfrac{m-1}{m_t-1} - 1\right),~m > 1
\end{align}
(in all inequalities, equality is achieved iff $m = m_t$).

Therefore,
\begin{figure*}[!htb]
\begin{align}
    - \log p(\bm{h}) \leq -n&\left(m\log m_t + 2(m - m_t) - m\log\Omega - \log\Gamma(m_t) +
        \left(m_t - \dfrac{1}{2}\right)\log (m_t-1) - \dfrac{1}{2}\log(m-1)\right. \nonumber\\
        &\left.-(m-1)\left(\log (m_t-1) + \dfrac{m-1}{m_t-1} - 1\right)
        \right) +m\left(\dfrac{\sum_{i=1}^{n}h_i^2}{\Omega} - 2\sum_{i=1}^{n}\log h_i\right), m \geq m_t > 1.
\end{align}
\end{figure*}

\begin{figure*}[!htb]
    \begin{align}
    \dfrac{\partial g(m | m_t)}{\partial m} = -n\left(\log m_t + 2 - \log\Omega - \dfrac{1}{2(m - 1)}
    - \left(\log (m_t - 1) - 1\right) + \dfrac{-2m + 1}{m_t - 1} \right)
    + \dfrac{\sum_{i=1}^{n}h_i^2}{\Omega} - 2\sum_{i=1}^{n}\log h_i = 0
    \end{align}
\end{figure*}

\begin{figure*}[!htb]
    \begin{align}
        2(m - 1) \left(-n\left(\log m_t + 2 - \log\Omega - (\log(m_t - 1) - 1)\right) + \dfrac{\sum_{i=1}^{n}h_i^2}{\Omega} - 2\sum_{i=1}^{n}\log h_i \right) + n - \dfrac{2n}{m_t-1}(-2m^2 + 3m - 1) = 0\\
        2(m - 1) a + n - \dfrac{2n}{m_t-1}(-2m^2 + 3m - 1) = 0\\
        m^2\left(\dfrac{4n}{m_t - 1}\right) + m\left(\dfrac{6n}{m_t - 1} + 2a\right) -2a + n\left(\dfrac{m_t +1}{m_t - 1}\right) = 0\\
    \end{align}
\end{figure*}

\subsection{BER in Complex $\alpha-\mu$ Fading}

\section{Conclusions}

\section*{Acknowledgement}
The authors would like to thank the Federal University of Campina Grande (UFCG)
and the Institute for Advanced Studies in Communications (Iecom) for supporting
this research.

\bibliographystyle{IEEEtran}
\bibliography{IEEEabrv, yacoub.bib}

\end{document}
